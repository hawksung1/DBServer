<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Board</title>
    <script src="/js/jquery-3.2.1.min.js"></script>
    <script src="/js/socket.io.slim.js"></script>
	<style>
	td {border: solid 1px #000000}
	#request {font-size:20px; background-color:#ccd0ce;    width: fit-content ;     cursor: -webkit-grab;}
  #orderbydate {font-size:20px; background-color:#ccd0ce;    width: fit-content ;     cursor: -webkit-grab;}
  #orderbypay {font-size:20px; background-color:#ccd0ce;    width: fit-content ;     cursor: -webkit-grab;}
	</style>
</head>
<body>

  <div> 진행중인 의뢰 </div>
  <div>
  	<!--
  	<div id = "request">의뢰 리스트 가져오기</div>
  	-->
  	<table id = "doing_request">
      <thead>
        <tr>
          <td>의뢰번호</td>
          <td>의뢰자ID</td>
          <td>급여</td>
          <td>시작날짜</td>
          <td>완료날짜</td>
          <td>최소경력조건</td>
          <td>최소참여</td>
          <td>최대참여</td>
          <td>의뢰자평점</td>
          <td>프리랜서평점</td>
          <td>의뢰상태</td>
        </tr>
      </thead>
      <tbody>
      </tbody>
    </table>
  </div>

<br>
<br>
<br>
<div id = "orderbydate"> 날짜순 정렬 </div>
<br>
<div id = "orderbypay"> 임금순 정렬 </div>

<br>
<div> 의뢰 목록 </div>
<div>
	<!--
	<div id = "request">의뢰 리스트 가져오기</div>
	-->
	<table id = "req_list">
    <thead>
      <tr>
        <td>의뢰번호</td>
        <td>의뢰자ID</td>
        <td>급여</td>
        <td>시작날짜</td>
        <td>완료날짜</td>
        <td>최소경력조건</td>
        <td>최소참여</td>
        <td>최대참여</td>
        <td>의뢰자평점</td>
        <td>프리랜서평점</td>
        <td>의뢰상태</td>
      </tr>
    </thead>
    <tbody>
    </tbody>
  </table>
</div>

<script>
    $(function() {
      var socket = io();
      //asd는 모르겟고... 그냥 통신 시작될때 작동하는 함수.
      socket.on('asd', function(msg) {
        $.ajax({
            type: 'get',
            url: '/request',
            success: function(data) {
          $('#req_list tbody').html("")
          //$('#user_list tbody').empty();
          for(var i = 0 ; i < data.length; i ++) {
             var will_be_append = $('<tr><td>'+data[i].RID+'</td><td>' + data[i].PID+'</td><td>' +
               data[i].Pay+'</td><td>' + data[i].StartDate+'</td><td>' +
                 data[i].EndDate+'</td><td>' + data[i].MinCareer+'</td><td>' +
                   data[i].MinNum+'</td><td>' + data[i].MaxNum+'</td><td>' +
                     data[i].CGrade+'</td><td>' + data[i].FGrade+'</td><td>' +
                       data[i].State+'</td></tr>' )

            $('#req_list tbody').append(will_be_append)
          }
        },
            error: function(err) {
              console.log(err);
            }
        });

        $.ajax({
            type: 'get',
            url: '/request/doing',
            success: function(data) {
          $('#doing_request tbody').html("")
          //$('#user_list tbody').empty();
          for(var i = 0 ; i < data.length; i ++) {
             var will_be_append = $('<tr><td>'+data[i].RID+'</td><td>' + data[i].PID+'</td><td>' +
               data[i].Pay+'</td><td>' + data[i].StartDate+'</td><td>' +
                 data[i].EndDate+'</td><td>' + data[i].MinCareer+'</td><td>' +
                   data[i].MinNum+'</td><td>' + data[i].MaxNum+'</td><td>' +
                     data[i].CGrade+'</td><td>' + data[i].FGrade+'</td><td>' +
                       data[i].State+'</td></tr>' )

            $('#doing_request tbody').append(will_be_append)
          }
        },
            error: function(err) {
              console.log(err);
            }
        });

      })

      $('#orderbydate').click('orderbydate', function(){
        $.ajax({
            type: 'get',
            url: '/request/orderbydate',
            success: function(data) {
          $('#req_list tbody').html("")
          //$('#user_list tbody').empty();
          for(var i = 0 ; i < data.length; i ++) {
             var will_be_append = $('<tr><td>'+data[i].RID+'</td><td>' + data[i].PID+'</td><td>' + data[i].Pay+'</td><td>' + data[i].StartDate+'</td><td>' + data[i].EndDate+'</td><td>' + data[i].MinCareer+'</td><td>' + data[i].MinNum+'</td><td>' + data[i].MaxNum+'</td><td>' + data[i].CGrade+'</td><td>' + data[i].FGrade+'</td><td>' + data[i].State+'</td></tr>' )
                 $('#req_list tbody').append(will_be_append)
          }
        },
            error: function(err) {
              console.log(err);
            }
        });

      })
      $('#orderbypay').click('orderbypay', function(){
        $.ajax({
            type: 'get',
            url: '/request/orderbypay',
            success: function(data) {
          $('#req_list tbody').html("")
          //$('#user_list tbody').empty();
          for(var i = 0 ; i < data.length; i ++) {
             var will_be_append = $('<tr><td>'+data[i].RID+'</td><td>' + data[i].PID+'</td><td>' + data[i].Pay+'</td><td>' + data[i].StartDate+'</td><td>' + data[i].EndDate+'</td><td>' + data[i].MinCareer+'</td><td>' + data[i].MinNum+'</td><td>' + data[i].MaxNum+'</td><td>' + data[i].CGrade+'</td><td>' + data[i].FGrade+'</td><td>' + data[i].State+'</td></tr>' )
                 $('#req_list tbody').append(will_be_append)
          }
        },
            error: function(err) {
              console.log(err);
            }
        });

      })

    });
</script>
</body>
</html>
