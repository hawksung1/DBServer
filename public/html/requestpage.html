<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Board</title>
    <script src="/js/jquery-3.2.1.min.js"></script>
    <script src="/js/socket.io.slim.js"></script>
	<style>
	td {border: solid 1px #000000}
	#rejectM {font-size:20px; background-color:#ccd0ce;    width: fit-content ;     cursor: -webkit-grab;}
	#getTeam {font-size:20px; background-color:#ccd0ce;    width: fit-content ;     cursor: -webkit-grab;}
	#refresh {font-size:20px; background-color:#ccd0ce;    width: fit-content ;     cursor: -webkit-grab;}
	#request_PC {font-size:20px; background-color:#ccd0ce;    width: fit-content ;     cursor: -webkit-grab;}
	#requestDate {font-size:20px; background-color:#ccd0ce;    width: fit-content ;     cursor: -webkit-grab;}
	#requestPay {font-size:20px; background-color:#ccd0ce;    width: fit-content ;     cursor: -webkit-grab;}
	#createR {font-size:20px; background-color:#ccd0ce;    width: fit-content ;     cursor: -webkit-grab;}
	</style>
</head>
<body>
<div>
<input type='button' value ='페이지 이동' onclick="movepage()"/>
<script> function movepage(){ location.href="/request_create.js"}</script>
</div>

<hr color="red" width=100%>

<div id='finishProj'>

<form>
<input type="radio" name="state" value="5" id='finish'>완료하기</div>
<input type="radio" name="state" value="4" id='reject'>거절하기</div>
<input type="button" value="전송" id='sendstate'>
</form>
</div>




<hr color="red" width=100%>


<div id='rejectM'>

<div>메세지 ID : <input type='text' id ='mID' name ='mID'></div>
<div>의뢰번호 : <input type='text' id ='mRID' name ='mRID'></div>
<div>의뢰자 : <input type='text' id='mPID' name='mPID'></div>
<div>프리랜서 : <input type='text' id='mFID' name='mFID'></div>
<form id="mContent">
<div>거절 메세지 <br><textarea rows="4" cols="50" name="comment" form="mContent"></textarea></div>
<input type="button" value="보내기" id='sendRejectM'>
</form>
</div>



<hr color="red" width=100%>




<div>
<div >팀 목록가져오기</div>
<table id = "team_list">
<thead>
<tr><td>번호</td>
<td>의뢰번호</td>
<td>팀이름</td>

</tr>
</tread>
<tbody></tbody>
</table>

</div>

<hr color="red" width=100%>


<div id='insert'>
<div>의뢰번호 : <input type='text' id ='Rnum' name ='Rnum'></div>
<div>의뢰자 : <input type='text' id='Name' name='Name'></div>
<div>의뢰금액 : <input type='text' id ='Pay' name ='Pay'></div>
<div>최소 경력 년수 : <input type='text' id ='Cyear' name ='Cyear'></div>
<div>최소 인원수 : <input type='text' id ='MinNum' name ='MinNum'></div>
<div>최대 인원수 : <input type='text' id ='MaxNum' name ='MaxNum'></div>
<!--<div>언어 별 능숙도 : <input type='text' name ='Prog' value=''></div>-->
<!--<div>의뢰 문서 : <input type='text' name ='Rdoc' value=''></div>-->
<div id='createR'>의뢰 생성</div>
</div>

<hr color="red" width=100%>
<div>
	<div id = "refresh">새로고침</div>
	<div id = "request_PC">의뢰 리스트 가져오기 일반</div>
	<div id = "requestDate">의뢰 리스트 가져오기 날짜</div>
	<div id = "requestPay">의뢰 리스트 가져오기 금액</div>
	<table id = "req_list"><thead><tr><td>번호</td><td>의뢰번호</td><td>의뢰자ID</td><td>급여</td><td>시작날짜</td><td>완료날짜</td><td>최소경력조건</td><td>최소참여</td><td>최대참여</td><td>의뢰자평점</td><td>프리랜서평점</td><td>의뢰상태</td></tr></thead><tbody></tbody></table>
</div>

<div id="a">a</div>

<script>



    $(function() {
      var socket = io();

      socket.on('asd', function(msg) {
        console.log(msg);
      });

	<!--goto 클릭하면 board 라는 html로 가게 만듦 -->
	 $('#goto').click(function(){
		$.ajax({
        type: 'get',
        url: '/board',
        success: function(data) {
			console.log("함수진입");
			location.href = "board";
		}
		});
	})
	  <!-- 여기까지-->

	  <!-- 함수3. 선택된 의뢰를 신청한팀 목록에서 팀을 눌러 신청완료 후 의뢰 진행 상태 변경 -->
	$.fn.selectTeam = function(teamN){

		console.log("시발");
		console.log(teamN);


		var v = {
			teamName: TeamName,

		}


        $.ajax({
        type: 'post',
        url: '/teamList/selectTeam',
		data: v,
        success: function(data) {

          console.log("팀 선택 완료, 의뢰를 진행합니다.");

		},
        error: function(err) {
		  console.log("팀 선택 실패, 에러");
          console.log(err);
        }
      });
      }
	  <!-- 함수3 끝 -->

	  <!-- 함수2.의뢰 목록 중 하나를 선택, 선택된 의뢰를 신청한팀 목록을 보여주는 함수 -->
	$.fn.gotoR = function(RID){

		console.log(RID);

		var v = {
			rID: RID,
		}


        $.ajax({
        type: 'post',
        url: '/teamList/getTeam',
		data: v,
        success: function(data) {
		  $('#user_list tbody').html("")
		  for(var i = 0 ; i < data.length; i ++) {
			 var tr_num = i+1;
			 var teamN = data[i].TName;
			 console.log(teamN);
		     var will_be_append = $( '<tr onclick=$(this).selectTeam('+teamN+')><td>'+tr_num+'</td>'
			 +'<td>'+data[i].RID+'</td>'
			 +'<td>'+data[i].TName+'</td></tr>')
             $('#team_list tbody').append(will_be_append)
		  }
		 console.log("신청한 팀목록 불러오기 성공");
        },
        error: function(err) {
          console.log(err);
        }
      });
      }
	  <!-- 함수2 끝 -->





	  $('#sendRejectM').click(function(){
	    var v = {
			mID: $("#rejectM #mID").val(),
			mRID: $("#rejectM #mRID").val(),
			mPID: $("#rejectM #mPID").val(),
			mFID: $("#rejectM #mFID").val(),
			mContent: $("#rejectM #mContent").val(),


		}
		$.ajax({
        type: 'post',
        url: '/sendM/sendRejectM',
		data: v,
        success: function(data) {
		  alert("insert 성공")
		},
        error: function(err) {
          console.log(err);
        }
      });

	  });





	  /*
	  $('#getTeam').click(function(){
		$.ajax({
        type: 'get',
        url: '/teamList',
        success: function(data) {
		  $('#user_list tbody').html("")
		  for(var i = 0 ; i < data.length; i ++) {
			 var tr_num = i+1;
		     var will_be_append = $('<tr id='+tr_num+'><td><a href="#a">'+tr_num+'</a></td><td>'+data[i].TeamName+'</td><td>'+data[i].ProjLeaderID+'</td></tr>' )
             $('#team_list tbody').append(will_be_append)
		  }
		},
        error: function(err) {
          console.log(err);
        }
      });
	  });
	  */



	  $('#refresh').click(function() {
			location.reload();
		});




	  $('#request_PC').click(function(){
		$.ajax({
        type: 'get',
        url: '/request_PC/request',
        success: function(data) {
		  $('#user_list tbody').html("")
		  for(var i = 0 ; i < data.length; i ++) {
			 var tr_num = i+1;
		     var will_be_append = $('<tr onclick=$(this).gotoR('+data[i].RID+')><td>'+tr_num+'</td>'
			 +'<td>'+data[i].RID+'</td><td>' + data[i].PID+'</td>'
			 +'<td>' + data[i].Pay+'</td><td>' + data[i].StartDate+'</td>'
			 +'<td>' + data[i].EndDate+'</td><td>' + data[i].MinCareer+'</td>'
			 +'<td>' + data[i].MinNum+'</td><td>' + data[i].MaxNum+'</td>'
			 +'<td>' + data[i].CGrade+'</td><td>' + data[i].FGrade+'</td>'
			 +'<td>' + data[i].State+'</td></tr>' )
             $('#req_list tbody').append(will_be_append)
		  }
		},
        error: function(err) {
          console.log(err);
        }
      });
	  });

	 $('#requestDate').click(function(){
		$.ajax({
        type: 'get',
        url: '/request_PC/requestDate',
        success: function(data) {
		  $('#user_list tbody').html("")
		  for(var i = 0 ; i < data.length; i ++) {
			 var tr_num = i+1;
		     var will_be_append = $('<tr onclick=$(this).gotoR('+data[i].RID+')><td>'+tr_num+'</td>'
			 +'<td>'+data[i].RID+'</td><td>' + data[i].PID+'</td>'
			 +'<td>' + data[i].Pay+'</td><td>' + data[i].StartDate+'</td>'
			 +'<td>' + data[i].EndDate+'</td><td>' + data[i].MinCareer+'</td>'
			 +'<td>' + data[i].MinNum+'</td><td>' + data[i].MaxNum+'</td>'
			 +'<td>' + data[i].CGrade+'</td><td>' + data[i].FGrade+'</td>'
			 +'<td>' + data[i].State+'</td></tr>' )
             $('#req_list tbody').append(will_be_append)
		  }
		},
        error: function(err) {
          console.log(err);
        }
      });
	  });


	  $('#requestPay').click(function(){
		$.ajax({
        type: 'get',
        url: '/request_PC/requestPay',
        success: function(data) {
		  $('#user_list tbody').html("")
		  for(var i = 0 ; i < data.length; i ++) {
			 var tr_num = i+1;
		     var will_be_append = $('<tr onclick=$(this).gotoR('+data[i].RID+')><td>'+tr_num+'</td>'
			 +'<td>'+data[i].RID+'</td><td>' + data[i].PID+'</td>'
			 +'<td>' + data[i].Pay+'</td><td>' + data[i].StartDate+'</td>'
			 +'<td>' + data[i].EndDate+'</td><td>' + data[i].MinCareer+'</td>'
			 +'<td>' + data[i].MinNum+'</td><td>' + data[i].MaxNum+'</td>'
			 +'<td>' + data[i].CGrade+'</td><td>' + data[i].FGrade+'</td>'
			 +'<td>' + data[i].State+'</td></tr>' )
             $('#req_list tbody').append(will_be_append)
		  }
		},
        error: function(err) {
          console.log(err);
        }
      });
	  });



	   $('#createR').click(function(){
	    var v = {
			rnum: $("#insert #Rnum").val(),
			name: $("#insert #Name").val(),
			pay: $("#insert #Pay").val(),
			minNum: $("#insert #MinNum").val(),
			maxNum: $("#insert #MaxNum").val(),
			cyear: $("#insert #Cyear").val(),
			//Prog: $("#insert #Prog").val(),
			//Rdoc: $("#insert #Rdoc").val(),


		}
		$.ajax({
        type: 'post',
        url: '/request_PC/insert',
		data: v,
        success: function(data) {
		  alert("insert 성공")
		},
        error: function(err) {
          console.log(err);
        }
      });

	  });



    });
</script>
</body>
</html>
